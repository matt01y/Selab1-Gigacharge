rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
  	
    match /accounts/{uid} {
    	allow write, create: if authenticated() && request.auth.uid == uid
    }
    
    match /queues/{location}/joins/{document=*} {
    	allow write, create: if enabled() && fieldExists('joinedAt') && request.resource.data['joinedAt'] == request.time
    }
    
    function authenticated(){
    	return request.auth != null
    }
    
    function enabled(){
    	return authenticated() && request.auth.token.enabled == "true"
    }
    
  }
}